dag:
  name: ding.dong
  behavior:
    schedule: 0 2 * * *
    start_date: 2023, 6, 14
    depends_on_past: True
    catch_up: False
    retry:
      count: 0
      delay_in_minute: 1
  tags:
    - postgres
    - bigquery
    - upsert
  owner: example@email.com
  priority_weight: 1
task:
  type: postgres_to_bq
  mode: spark
  source:
    connection: pg_ding
    schema: public
    table: dong
    timestamp_keys:
      - created_at
      - updated_at
    unique_keys:
      - id
  target:
    bq:
      project: pocz-389704
      dataset: ding
      table: dong
      load_method: upsert
      partition_field: created_at
      cluster_fields: ~
